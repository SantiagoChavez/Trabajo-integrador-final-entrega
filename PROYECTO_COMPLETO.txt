
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\PreentregaJavaGestionApplication.java
==================================================
package com.entregaFinal.gestion;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class PreentregaJavaGestionApplication {
    public static void main(String[] args) {
        SpringApplication.run(PreentregaJavaGestionApplication.class, args);
    }
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\WebConfig.java
==================================================
package com.entregaFinal.gestion;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class WebConfig {

    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/api/**")
                        .allowedOrigins("http://localhost:5176")
                        .allowedMethods("GET", "POST", "PUT", "DELETE")
                        .allowedHeaders("*");
            }
        };
    }
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\controller\AuthController.java
==================================================
package com.entregaFinal.gestion.controller;

import com.entregaFinal.gestion.model.Usuario;
import com.entregaFinal.gestion.repository.UsuarioRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/api/auth")
public class AuthController {

    @Autowired
    private UsuarioRepository usuarioRepository;

    // Endpoint para Login
    @PostMapping("/login")
    public Usuario login(@RequestBody Map<String, String> credenciales) {
        String username = credenciales.get("username");
        String password = credenciales.get("password");

        Usuario usuario = usuarioRepository.findByUsername(username)
                .orElseThrow(() -> new RuntimeException("Usuario no encontrado"));

        if (usuario.getPassword().equals(password)) {
            return usuario; // Login exitoso, devolvemos el usuario con su rol
        } else {
            throw new RuntimeException("Contrase√±a incorrecta");
        }
    }

    // Endpoint para registrarse (Para que puedas crear usuarios)
    @PostMapping("/registro")
    public Usuario registrar(@RequestBody Usuario usuario) {
        if (usuarioRepository.findByUsername(usuario.getUsername()).isPresent()) {
            throw new RuntimeException("El usuario ya existe");
        }
        // Por defecto rol USER si no se especifica
        if (usuario.getRol() == null) {
            usuario.setRol("USER");
        }
        return usuarioRepository.save(usuario);
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\controller\PedidoController.java
==================================================
package com.entregaFinal.gestion.controller;

import com.entregaFinal.gestion.model.Pedido;
import com.entregaFinal.gestion.service.PedidoService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/pedidos")
public class PedidoController {

    @Autowired
    private PedidoService pedidoService;

    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public Pedido createPedido(@RequestBody Pedido pedido) {
        System.out.println("===== PEDIDO RECIBIDO =====");
        System.out.println("Estado: " + pedido.getEstado());
        System.out.println("Fecha: " + pedido.getFecha());
        System.out.println("Total: " + pedido.getTotal());
        if (pedido.getLineas() != null) {
            for (int i = 0; i < pedido.getLineas().size(); i++) {
                System.out.println("L√≠nea " + (i + 1));
                System.out.println(" - Producto ID: " + pedido.getLineas().get(i).getProductoId());
                System.out.println(" - Cantidad: " + pedido.getLineas().get(i).getCantidad());
            }
        } else {
            System.out.println("No hay l√≠neas de pedido.");
        }
        return pedidoService.createPedido(pedido);
    }

    @GetMapping
    public List<Pedido> getAllPedidos() {
        return pedidoService.getAllPedidos();
    }

    @PutMapping("/{id}/estado")
    public Pedido actualizarEstado(@PathVariable String id, @RequestParam String nuevoEstado) {
        return pedidoService.updateEstado(id, nuevoEstado);
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\controller\ProductoController.java
==================================================
package com.entregaFinal.gestion.controller;

import com.entregaFinal.gestion.model.Producto;
import com.entregaFinal.gestion.service.ProductoService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.Optional;

@RestController
@RequestMapping("/api/productos")
public class ProductoController {

    @Autowired
    private ProductoService productoService;

    @GetMapping
    public List<Producto> getAllProductos() {
        return productoService.getAllProductos();
    }

    @GetMapping("/{id}")
    public Optional<Producto> getProductoById(@PathVariable String id) {
        return productoService.getProductoById(id);
    }

    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public Producto addProducto(@RequestBody Producto producto) {
        return productoService.addProducto(producto);
    }

    @PutMapping("/{id}")
    public Producto updateProducto(@PathVariable String id, @RequestBody Producto producto) {
        return productoService.updateProducto(id, producto);
    }

    @DeleteMapping("/{id}")
    public boolean deleteProducto(@PathVariable String id) {
        return productoService.deleteProducto(id);
    }
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\exception\StockInsuficienteException.java
==================================================
package com.entregaFinal.gestion.exception;

public class StockInsuficienteException extends RuntimeException {
    public StockInsuficienteException(String message) {
        super(message);
    }
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\model\LineaPedido.java
==================================================
package com.entregaFinal.gestion.model;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

@JsonIgnoreProperties(ignoreUnknown = true)
public class LineaPedido {

    private Integer id;
    private String productoId;  // ‚úÖ CAMBIAR de Integer a String
    private String productoNombre;
    private Double productoPrecio;
    private Integer cantidad;

    // Constructores
    public LineaPedido() {
    }

    public LineaPedido(Integer id, String productoId, String productoNombre,
                       Double productoPrecio, Integer cantidad) {
        this.id = id;
        this.productoId = productoId;
        this.productoNombre = productoNombre;
        this.productoPrecio = productoPrecio;
        this.cantidad = cantidad;
    }

    // Getters y Setters
    public Integer getId() { return id; }
    public void setId(Integer id) { this.id = id; }

    public String getProductoId() { return productoId; }  // ‚úÖ CAMBIAR retorno a String
    public void setProductoId(String productoId) { this.productoId = productoId; }  // ‚úÖ CAMBIAR par√°metro a String

    public String getProductoNombre() { return productoNombre; }
    public void setProductoNombre(String productoNombre) { this.productoNombre = productoNombre; }

    public Double getProductoPrecio() { return productoPrecio; }
    public void setProductoPrecio(Double productoPrecio) { this.productoPrecio = productoPrecio; }

    public Integer getCantidad() { return cantidad; }
    public void setCantidad(Integer cantidad) { this.cantidad = cantidad; }

    // M√©todo √∫til para calcular el subtotal
    public Double getSubtotal() {
        return productoPrecio * cantidad;
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\model\Pedido.java
==================================================
package com.entregaFinal.gestion.model;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.*;

@Document(collection = "pedidos")
public class Pedido {

    @Id
    private String id;
    private Date fecha = new Date();
    private String estado;
    private Double total;
    private List<LineaPedido> lineas;

    public Pedido() {
        this.lineas = new ArrayList<>();
    }

    public Pedido(String id, Date fecha, String estado, Double total, List<LineaPedido> lineas) {
        this.id = id;
        this.fecha = fecha;
        this.estado = estado;
        this.total = total;
        this.lineas = lineas != null ? lineas : new ArrayList<>();
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public Date getFecha() {
        return fecha;
    }

    public void setFecha(Date fecha) {
        this.fecha = fecha;
    }

    public String getEstado() {
        return estado;
    }

    public void setEstado(String estado) {
        this.estado = estado;
    }

    public Double getTotal() {
        return total;
    }

    public void setTotal(Double total) {
        this.total = total;
    }

    public List<LineaPedido> getLineas() {
        return lineas;
    }

    public void setLineas(List<LineaPedido> lineas) {
        this.lineas = lineas;
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\model\Producto.java
==================================================
package com.entregaFinal.gestion.model;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

@Document(collection = "productos") // indica que los documentos van a esta colecci√≥n
public class Producto {

    @Id
    private String id; // en Mongo el id es String (ObjectId), no Integer

    private String nombre;
    private String descripcion;
    private Double precio;
    private String categoria;
    private String imagenUrl;
    private Integer stock;

    // Constructor vac√≠o (necesario para la deserializaci√≥n)
    public Producto() {}

    // Constructor completo (sin el id, ya que Mongo lo genera autom√°ticamente)
    public Producto(String nombre, String descripcion, Double precio,
                    String categoria, String imagenUrl, Integer stock) {
        this.nombre = nombre;
        this.descripcion = descripcion;
        this.precio = precio;
        this.categoria = categoria;
        this.imagenUrl = imagenUrl;
        this.stock = stock;
    }

    // Getters y Setters
    public String getId() { return id; }
    public void setId(String id) { this.id = id; }

    public String getNombre() { return nombre; }
    public void setNombre(String nombre) { this.nombre = nombre; }

    public String getDescripcion() { return descripcion; }
    public void setDescripcion(String descripcion) { this.descripcion = descripcion; }

    public Double getPrecio() { return precio; }
    public void setPrecio(Double precio) { this.precio = precio; }

    public String getCategoria() { return categoria; }
    public void setCategoria(String categoria) { this.categoria = categoria; }

    public String getImagenUrl() { return imagenUrl; }
    public void setImagenUrl(String imagenUrl) { this.imagenUrl = imagenUrl; }

    public Integer getStock() { return stock; }
    public void setStock(Integer stock) { this.stock = stock; }
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\model\Usuario.java
==================================================
package com.entregaFinal.gestion.model;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

@Document(collection = "usuarios")
public class Usuario {
    @Id
    private String id;
    private String username;
    private String password; // En producci√≥n esto ir√≠a encriptado
    private String rol; // "ADMIN" o "USER"

    public Usuario() {}

    public Usuario(String username, String password, String rol) {
        this.username = username;
        this.password = password;
        this.rol = rol;
    }

    // Getters y Setters
    public String getId() { return id; }
    public void setId(String id) { this.id = id; }
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
    public String getPassword() { return password; }
    public void setPassword(String password) { this.password = password; }
    public String getRol() { return rol; }
    public void setRol(String rol) { this.rol = rol; }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\repository\DataInitializer.java
==================================================
package com.entregaFinal.gestion.repository; // <--- CAMBIO AQU√ç

import com.entregaFinal.gestion.model.Usuario;
// Nota: Ya no hace falta importar UsuarioRepository porque estamos en la misma carpeta
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class DataInitializer implements CommandLineRunner {

    private final UsuarioRepository usuarioRepository;

    public DataInitializer(UsuarioRepository usuarioRepository) {
        this.usuarioRepository = usuarioRepository;
    }

    @Override
    public void run(String... args) throws Exception {
        System.out.println("üîÑ Verificando usuarios iniciales...");

        // 1. Crear ADMIN si no existe
        if (usuarioRepository.findByUsername("admin").isEmpty()) {
            Usuario admin = new Usuario("admin", "1234", "ADMIN");
            usuarioRepository.save(admin);
            System.out.println("‚úÖ USUARIO ADMIN CREADO: admin / 1234");
        } else {
            System.out.println("üëå El usuario admin ya existe.");
        }

        // 2. Crear CLIENTE de prueba si no existe
        if (usuarioRepository.findByUsername("cliente").isEmpty()) {
            Usuario user = new Usuario("cliente", "1234", "USER");
            usuarioRepository.save(user);
            System.out.println("‚úÖ USUARIO CLIENTE CREADO: cliente / 1234");
        }
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\repository\PedidoRepository.java
==================================================
package com.entregaFinal.gestion.repository;

import com.entregaFinal.gestion.model.Pedido;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface PedidoRepository extends MongoRepository<Pedido, String> {
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\repository\ProductoRepository.java
==================================================
package com.entregaFinal.gestion.repository;

import com.entregaFinal.gestion.model.Producto;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface ProductoRepository extends MongoRepository<Producto, String> {
    // Spring Data Mongo se encarga de:
    // findAll(), findById(String id), save(Producto producto), deleteById(String id), existsById(String id)

    // Si quer√©s, pod√©s agregar consultas personalizadas:
    // List<Producto> findByCategoria(String categoria);
}

==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\repository\UsuarioRepository.java
==================================================
package com.entregaFinal.gestion.repository;

import com.entregaFinal.gestion.model.Usuario;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.stereotype.Repository;
import java.util.Optional;

@Repository
public interface UsuarioRepository extends MongoRepository<Usuario, String> {
    Optional<Usuario> findByUsername(String username);
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\service\PedidoService.java
==================================================
package com.entregaFinal.gestion.service;

import com.entregaFinal.gestion.exception.StockInsuficienteException; // Aseg√∫rate de importar tu excepci√≥n
import com.entregaFinal.gestion.model.Pedido;
import com.entregaFinal.gestion.model.LineaPedido;
import com.entregaFinal.gestion.model.Producto;
import com.entregaFinal.gestion.repository.PedidoRepository;
import com.entregaFinal.gestion.repository.ProductoRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import java.util.ArrayList;
import java.util.List;

@Service
@SuppressWarnings("null")
public class PedidoService {

    @Autowired
    private PedidoRepository pedidoRepository;
    @Autowired
    private ProductoRepository productoRepository;

    // @Transactional // Descomentar si usaras SQL relacional, en Mongo se maneja diferente pero el concepto aplica
    public Pedido createPedido(Pedido pedido) {
        double total = 0;
        List<LineaPedido> lineasActualizadas = new ArrayList<>();

        for (LineaPedido linea : pedido.getLineas()) {
            String productoId = linea.getProductoId();
            // Buscamos el producto
            Producto producto = productoRepository.findById(productoId)
                    .orElseThrow(() -> new RuntimeException("Producto con ID " + productoId + " no encontrado"));

            // 1. Validar Stock en el Backend (Seguridad)
            if (producto.getStock() < linea.getCantidad()) {
                throw new StockInsuficienteException("No hay stock suficiente para: " + producto.getNombre());
            }

            // 2. Actualizar datos de la l√≠nea (Precio y Nombre actuales)
            linea.setProductoNombre(producto.getNombre());
            linea.setProductoPrecio(producto.getPrecio());
            
            // 3. RESTAR STOCK Y GUARDAR EL PRODUCTO
            producto.setStock(producto.getStock() - linea.getCantidad());
            productoRepository.save(producto); // <--- ¬°ESTO FALTABA!

            // Calcular subtotal
            total += linea.getSubtotal();
            lineasActualizadas.add(linea);
        }

        pedido.setLineas(lineasActualizadas);
        pedido.setTotal(total);
        pedido.setEstado("PENDIENTE");
        return pedidoRepository.save(pedido);
    }

    public List<Pedido> getAllPedidos() {
        return pedidoRepository.findAll();
    }

    // M√©todo para cambiar el estado (FACTURADO, DESPACHADO, etc.)
    public Pedido updateEstado(String id, String nuevoEstado) {
        return pedidoRepository.findById(id).map(pedido -> {
            pedido.setEstado(nuevoEstado);
            return pedidoRepository.save(pedido);
        }).orElseThrow(() -> new RuntimeException("Pedido no encontrado"));
    }
}
==================================================
ARCHIVO: .\backend\src\main\java\com\entregaFinal\gestion\service\ProductoService.java
==================================================
package com.entregaFinal.gestion.service;

import com.entregaFinal.gestion.model.Producto;
import com.entregaFinal.gestion.repository.ProductoRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Optional;

@Service
public class ProductoService {

    @Autowired
    private ProductoRepository productoRepository;

    public List<Producto> getAllProductos() {
        return productoRepository.findAll();
    }

    public Optional<Producto> getProductoById(String id) {
        return productoRepository.findById(id);
    }

    public Producto addProducto(Producto producto) {
        return productoRepository.save(producto);
    }

    public Producto updateProducto(String id, Producto productoActualizado) {
        return productoRepository.findById(id).map(productoExistente -> {
            // Actualizamos campo por campo solo si el dato que llega no es null
            
            if(productoActualizado.getNombre() != null) 
                productoExistente.setNombre(productoActualizado.getNombre());
            
            if(productoActualizado.getDescripcion() != null) 
                productoExistente.setDescripcion(productoActualizado.getDescripcion());
            
            if(productoActualizado.getPrecio() != null) 
                productoExistente.setPrecio(productoActualizado.getPrecio());
            
            if(productoActualizado.getCategoria() != null) 
                productoExistente.setCategoria(productoActualizado.getCategoria());
            
            if(productoActualizado.getStock() != null) 
                productoExistente.setStock(productoActualizado.getStock());
            
            // Agregado para soportar la edici√≥n de imagen que hicimos en el Frontend
            if(productoActualizado.getImagenUrl() != null) 
                productoExistente.setImagenUrl(productoActualizado.getImagenUrl());

            return productoRepository.save(productoExistente);
        }).orElse(null);
    }

    public boolean deleteProducto(String id) {
        if (productoRepository.existsById(id)) {
            productoRepository.deleteById(id);
            return true;
        }
        return false;
    }
}
==================================================
ARCHIVO: .\frontend\index.html
==================================================
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Frontend React</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

==================================================
ARCHIVO: .\frontend\package.json
==================================================
{
  "name": "frontend",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.6.8",
    "jspdf": "^3.0.4",
    "jspdf-autotable": "^5.0.2",
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-icons": "^5.5.0",
    "react-router-dom": "^6.30.1"
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^4.7.0",
    "vite": "^5.4.19"
  }
}

==================================================
ARCHIVO: .\frontend\vite.config.js
==================================================
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  server: {
    port: 5176, // o el que prefieras
    strictPort: true, // da error si el puerto est√° ocupado, en lugar de cambiarlo
  },
});


==================================================
ARCHIVO: .\frontend\src\App.jsx
==================================================
import React, { useState } from 'react';
import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
// 1. IMPORTAMOS EL PROVEEDOR DE NOTIFICACIONES
import { NotificationProvider } from './context/NotificationContext';

import Navbar from './components/Navbar';
import ProductoList from './components/ProductoList';
import AgregarProducto from './components/AgregarProducto';
import Carrito from './components/Carrito';
import Pedidos from './components/Pedidos';
import Inicio from './components/Inicio';
import Categorias from './components/Categorias';
import Login from './components/Login';
import AdminPedidos from './components/AdminPedidos'; 
import './components/Admin.css'; 

const RutaPrivadaAdmin = ({ usuario, children }) => {
  if (!usuario) return <Navigate to="/login" />;
  if (usuario.rol !== 'ADMIN') return <Navigate to="/" />;
  return children;
};

function App() {
  const [carrito, setCarrito] = useState([]);
  const [busqueda, setBusqueda] = useState(""); 

  // 2. CORRECCI√ìN DE PERSISTENCIA: Leemos de localStorage al iniciar
  const [usuario, setUsuario] = useState(() => {
    const usuarioGuardado = localStorage.getItem("usuario");
    return usuarioGuardado ? JSON.parse(usuarioGuardado) : null;
  });

  // Guardamos en localStorage al loguear
  const handleLogin = (userData) => {
    setUsuario(userData);
    localStorage.setItem("usuario", JSON.stringify(userData));
  };

  // Borramos de localStorage al salir
  const handleLogout = () => { 
    setUsuario(null); 
    setCarrito([]); 
    localStorage.removeItem("usuario");
  };

  const agregarAlCarrito = (producto) => {
    if (producto.stock === 0) { alert("Sin stock"); return; }
    
    const itemEnCarrito = carrito.find((p) => p.id === producto.id);
    if (itemEnCarrito && itemEnCarrito.cantidad + 1 > producto.stock) {
      alert("Stock insuficiente"); return;
    }

    if (itemEnCarrito) {
      setCarrito(carrito.map(p => p.id === producto.id ? { ...p, cantidad: p.cantidad + 1 } : p));
    } else {
      setCarrito([...carrito, { ...producto, cantidad: 1 }]);
    }
    
    // 3. QUITAMOS EL ALERT DE AQU√ç
    // Ya no hacemos alert("‚úÖ Agregado") para que no salga la ventana gris.
    // El mensaje bonito lo mostrar√° ProductoList.jsx usando el contexto.
  };

  const restarDelCarrito = (id) => {
    const item = carrito.find((p) => p.id === id);
    if (!item) return;
    if (item.cantidad === 1) setCarrito(carrito.filter((p) => p.id !== id));
    else setCarrito(carrito.map((p) => p.id === id ? { ...p, cantidad: p.cantidad - 1 } : p));
  };

  const vaciarCarrito = () => setCarrito([]);

  return (
    // 4. ENVOLVEMOS TODO CON EL PROVEEDOR DE NOTIFICACIONES
    <NotificationProvider>
      <Router>
        <Navbar 
          usuario={usuario} 
          onLogout={handleLogout} 
          carrito={carrito} 
          busqueda={busqueda} 
          setBusqueda={setBusqueda} 
        />
        
        <main>
          <Routes>
            <Route path="/" element={<Inicio usuario={usuario} />} />
            <Route path="/login" element={<Login onLogin={handleLogin} />} />
            
            <Route path="/productos" element={
               <div style={{ padding: '20px', textAlign: 'center' }}>
                 <ProductoList agregarAlCarrito={agregarAlCarrito} esAdmin={false} busqueda={busqueda} />
               </div>
            } />

            <Route path="/carrito" element={
               <div style={{ padding: '20px', textAlign: 'center' }}>
                 <Carrito 
                    carrito={carrito} 
                    restarDelCarrito={restarDelCarrito} 
                    vaciarCarrito={vaciarCarrito} 
                    usuario={usuario} 
                 />
               </div>
            } />

            <Route path="/pedidos" element={<div style={{ padding: '20px' }}><Pedidos /></div>} />
            <Route path="/categorias" element={<Categorias />} />

            {/* --- ZONA ADMIN --- */}
            <Route path="/gestion" element={
              <RutaPrivadaAdmin usuario={usuario}>
                <div className="admin-container">
                  
                  <h1 className="admin-title">‚öôÔ∏è Panel de Operaciones</h1>
                  
                  {/* 1. Tarjeta de Alta */}
                  <div className="admin-card">
                     <h3 className="section-title">‚ûï Dar de Alta Nuevo Producto</h3>
                     <AgregarProducto />
                  </div>
                  
                  {/* 2. Tarjeta de Listado */}
                  <div style={{ maxWidth: '1000px', margin: '0 auto' }}>
                      <h3 className="section-title" style={{textAlign:'center', display:'block'}}>üìù Gesti√≥n de Stock</h3>
                      <ProductoList esAdmin={true} busqueda={busqueda} />
                  </div>

                  <hr style={{ margin: '60px auto', width: '80%', borderColor: '#333' }} />
                  
                  {/* 3. Pedidos y Facturaci√≥n */}
                  <div style={{ maxWidth: '1000px', margin: '0 auto' }}>
                    <AdminPedidos />
                  </div>
                  
                </div>
              </RutaPrivadaAdmin>
            } />

          </Routes>
        </main>
      </Router>
    </NotificationProvider>
  );
}

export default App;
==================================================
ARCHIVO: .\frontend\src\index.css
==================================================
body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
    Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  
  /* FONDO TECNOL√ìGICO */
  background-image: url('/tech-bg.jpg'); /* Asegurate que la imagen est√© en la carpeta public */
  background-size: cover;
  background-position: center;
  background-attachment: fixed; 
  background-repeat: no-repeat;
  min-height: 100vh;
}

/* Capa oscura para legibilidad */
body::before {
  content: "";
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  
  /* 1. CAMBIO AQU√ç: Baj√© la opacidad de 0.85 a 0.70 para que se vea m√°s la imagen */
  background: rgba(15, 15, 20, 0.70);
  
  /* 2. CAMBIO AQU√ç: Baj√© el desenfoque de 4px a 1px (Casi n√≠tido, solo suaviza un poco) */
  /* Si lo quieres TOTALMENTE n√≠tido, cambia 1px por 0px */
  backdrop-filter: blur(1px);         
  
  z-index: -1;
}
==================================================
ARCHIVO: .\frontend\src\main.jsx
==================================================
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)

==================================================
ARCHIVO: .\frontend\src\components\Admin.css
==================================================
/* --- FONDO GENERAL SUAVE --- */
.admin-container {
  min-height: 100vh;
  padding: 40px 20px;
  /* Cambio: De negro puro a un gris oscuro azulado (Dark Slate) */
  background-color: #1a1a24; 
  color: #c0c0d0; /* Texto gris claro, no blanco puro */
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  box-sizing: border-box;
}

/* --- T√çTULOS --- */
.admin-title {
  color: #82b1ff; /* Azul suave pastel */
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 30px;
  text-align: center;
  font-size: 2.2rem;
  font-weight: 600;
  /* Quitamos el text-shadow fuerte para que no encandile */
}

.section-title {
  color: #e0e0e0;
  border-bottom: 2px solid #3f51b5; /* L√≠nea m√°s oscura y sobria */
  display: inline-block;
  padding-bottom: 5px;
  margin-bottom: 25px;
  font-size: 1.4rem;
}

/* --- TARJETAS (SOBRIAS) --- */
.admin-card {
  background: #23232e; /* Fondo s√≥lido, no transparente */
  border: 1px solid #333; /* Borde sutil */
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sombra suave */
  border-radius: 12px;
  padding: 40px;
  margin: 0 auto 40px auto;
  max-width: 800px;
  text-align: center;
}

/* --- FORMULARIOS --- */
.admin-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
  max-width: 500px;
  margin: 0 auto;
}

.admin-form input {
  background-color: #2b2b36; /* Un poco m√°s claro que el fondo */
  border: 1px solid #444;
  color: #eee;
  padding: 12px;
  border-radius: 6px;
  outline: none;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.admin-form input:focus {
  border-color: #82b1ff; /* Acento suave al escribir */
}

.admin-form input::placeholder {
  color: #777;
}

/* --- BOT√ìN DE ENV√çO --- */
.btn-admin-submit {
  background-color: #3f51b5; /* Azul √≠ndigo mate */
  color: white;
  border: none;
  padding: 12px;
  border-radius: 6px; /* Menos redondo */
  font-weight: bold;
  cursor: pointer;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-top: 10px;
  transition: background-color 0.2s;
}

.btn-admin-submit:hover {
  background-color: #5c6bc0; /* Un poco m√°s claro al pasar el mouse */
}

/* --- NOTIFICACI√ìN FLOTANTE (REUTILIZABLE) --- */
.notificacion-oval {
  position: fixed;
  top: 50%;              /* Centrado Vertical */
  left: 50%;             /* Centrado Horizontal */
  transform: translate(-50%, -50%);
  
  background-color: rgba(30, 30, 40, 0.95); /* Fondo oscuro semitransparente */
  color: #00d2ff;        /* Texto Cyan Ne√≥n */
  border: 1px solid #00d2ff;
  
  padding: 20px 40px;
  border-radius: 50px;   
  
  font-family: 'Segoe UI', sans-serif;
  font-weight: 600;
  font-size: 1.1rem;
  text-align: center;
  
  box-shadow: 0 0 30px rgba(0, 210, 255, 0.2); /* Resplandor suave */
  z-index: 9999;
  
  animation: aparecerCentro 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes aparecerCentro {
  from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
  to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

/* --- MODAL DE CONFIRMACI√ìN (ESTILO GAMER) --- */
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.85); /* Fondo muy oscuro para bloquear */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000; /* Por encima de todo */
  backdrop-filter: blur(4px); /* Efecto borroso pro */
}

.modal-neon {
  background-color: #1a1a24;
  border: 1px solid #ff5252; /* Borde Rojo para acciones peligrosas */
  box-shadow: 0 0 20px rgba(255, 82, 82, 0.2);
  padding: 30px;
  border-radius: 12px;
  width: 400px;
  text-align: center;
  animation: aparecerSuave 0.2s ease-out;
}

.modal-neon h3 {
  color: #ff5252;
  margin-top: 0;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.modal-neon p {
  color: #ccc;
  font-size: 1rem;
  margin-bottom: 25px;
}

.modal-botones {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.btn-cancelar {
  background: transparent;
  border: 1px solid #555;
  color: #ccc;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
}

.btn-confirmar-rojo {
  background: rgba(255, 82, 82, 0.15);
  border: 1px solid #ff5252;
  color: #ff5252;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.2s;
}

.btn-confirmar-rojo:hover {
  background: #ff5252;
  color: white;
  box-shadow: 0 0 15px rgba(255, 82, 82, 0.5);
}
==================================================
ARCHIVO: .\frontend\src\components\AdminPedidos.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { generarFacturaPDF } from '../utils/facturaPDF'; 

function AdminPedidos() {
  const [pedidos, setPedidos] = useState([]);
  const [mensajeAlerta, setMensajeAlerta] = useState(null);
  
  // NUEVO ESTADO: Guarda qu√© pedido estamos a punto de anular para mostrar el modal
  const [pedidoAAnular, setPedidoAAnular] = useState(null);

  useEffect(() => {
    fetch("http://localhost:8080/api/pedidos")
      .then((res) => res.json())
      .then((data) => setPedidos(data))
      .catch((err) => console.error(err));
  }, []);

  const mostrarNotificacion = (texto) => {
      setMensajeAlerta(texto);
      setTimeout(() => setMensajeAlerta(null), 3000);
  };

  const handleFacturar = (pedido) => {
    try {
        generarFacturaPDF(pedido);
    } catch (error) {
        mostrarNotificacion("‚ùå Error al crear el PDF.");
        return;
    }

    if (pedido.estado === "FACTURADO") return;

    fetch(`http://localhost:8080/api/pedidos/${pedido.id}/estado?nuevoEstado=FACTURADO`, {
        method: "PUT"
    })
    .then(res => {
        if (!res.ok) throw new Error("Error");
        return res.json();
    })
    .then(() => {
        setPedidos(prev => prev.map(p => 
            p.id === pedido.id ? { ...p, estado: "FACTURADO" } : p
        ));
    })
    .catch(err => console.error(err));
  };

  // 1. PRIMER PASO: El usuario toca "Anular" y abrimos el modal (NO hacemos fetch todav√≠a)
  const abrirModalAnular = (pedido) => {
      setPedidoAAnular(pedido);
  };

  // 2. SEGUNDO PASO: El usuario confirm√≥ en el modal, ahora s√≠ ejecutamos
  const confirmarAnulacion = () => {
      if (!pedidoAAnular) return;

      fetch(`http://localhost:8080/api/pedidos/${pedidoAAnular.id}/estado?nuevoEstado=PENDIENTE`, {
          method: "PUT"
      })
      .then(res => {
          if (!res.ok) throw new Error("Error");
          return res.json();
      })
      .then(() => {
          setPedidos(prev => prev.map(p => 
              p.id === pedidoAAnular.id ? { ...p, estado: "PENDIENTE" } : p
          ));
          mostrarNotificacion("‚úÖ Factura anulada. Listo para corregir.");
          setPedidoAAnular(null); // Cerramos el modal
      })
      .catch(() => {
          mostrarNotificacion("‚ùå Error al conectar con el servidor.");
          setPedidoAAnular(null);
      });
  };

  const handleDespachar = (pedido) => {
    if (pedido.estado !== "FACTURADO") {
        mostrarNotificacion("‚ö†Ô∏è Debes facturar antes de despachar.");
        return;
    }
    const tracking = "TRK-" + Math.floor(Math.random() * 99999);
    mostrarNotificacion(`üöö Pedido despachado. Tracking: ${tracking}`);
  };

  return (
    <div style={{ 
        padding: '20px', 
        color: '#e0e0e0', 
        background: '#1e1e2f', 
        borderRadius: '8px',
        border: '1px solid #2d2d44',
        marginTop: '20px',
        boxShadow: '0 4px 6px rgba(0,0,0,0.3)'
    }}>
      
      {/* --- NOTIFICACI√ìN FLOTANTE --- */}
      {mensajeAlerta && (
          <div className="notificacion-oval">
              {mensajeAlerta}
          </div>
      )}

      {/* --- MODAL DE CONFIRMACI√ìN PROPIO (Solo se muestra si pedidoAAnular tiene datos) --- */}
      {pedidoAAnular && (
          <div className="modal-backdrop">
              <div className="modal-neon">
                  <h3>‚ö†Ô∏è Confirmar Anulaci√≥n</h3>
                  <p>
                      ¬øEst√°s seguro de anular la factura del pedido 
                      <strong style={{color: 'white'}}> {pedidoAAnular.id.substring(0,8)}</strong>?
                      <br/><br/>
                      <span style={{fontSize:'0.9rem', opacity:0.8}}>El estado volver√° a "PENDIENTE" para que puedas editar y refacturar.</span>
                  </p>
                  <div className="modal-botones">
                      <button className="btn-cancelar" onClick={() => setPedidoAAnular(null)}>
                          Cancelar
                      </button>
                      <button className="btn-confirmar-rojo" onClick={confirmarAnulacion}>
                          S√≠, Anular
                      </button>
                  </div>
              </div>
          </div>
      )}

      <h3 style={{ 
          color: '#a0a0b0', borderBottom: '1px solid #2d2d44', 
          paddingBottom: '10px', textAlign: 'center', 
          textTransform: 'uppercase', letterSpacing: '2px'
      }}>
        ‚öôÔ∏è Control de Pedidos
      </h3>
      
      {pedidos.length === 0 ? (
        <p style={{ textAlign: 'center', color: '#666' }}>Sin pedidos pendientes.</p>
      ) : (
        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>
          <thead>
            <tr style={{ background: '#2d2d44', color: '#fff' }}>
              <th style={{ padding: '12px', textAlign: 'left' }}>ID Corto</th>
              <th style={{ padding: '12px', textAlign: 'center' }}>Estado</th>
              <th style={{ padding: '12px', textAlign: 'center' }}>√çtems</th>
              <th style={{ padding: '12px', textAlign: 'center', color: '#4caf50' }}>Facturaci√≥n</th>
              <th style={{ padding: '12px', textAlign: 'center', color: '#ff9800' }}>Log√≠stica</th>
            </tr>
          </thead>
          <tbody>
            {pedidos.map((p) => {
              const esFacturado = p.estado === "FACTURADO";
              return (
              <tr key={p.id} style={{ borderBottom: '1px solid #2d2d44' }}>
                <td style={{ padding: '10px', color: '#888', fontFamily: 'monospace' }}>
                    {p.id.substring(0, 8)}...
                </td>
                <td style={{ padding: '10px', textAlign: 'center' }}>
                    <span style={{ 
                        padding: '4px 10px', borderRadius: '4px', fontSize: '0.75rem', fontWeight: 'bold',
                        border: esFacturado ? '1px solid #4caf50' : '1px solid #00d2ff',
                        color: esFacturado ? '#4caf50' : '#00d2ff',
                        background: esFacturado ? 'rgba(76, 175, 80, 0.1)' : 'rgba(0, 210, 255, 0.1)'
                    }}>
                        {p.estado || "PENDIENTE"}
                    </span>
                </td>
                <td style={{ padding: '10px', textAlign: 'center', color: '#ccc' }}>
                    {p.lineas ? p.lineas.length : 0}
                </td>
                <td style={{ padding: '10px', textAlign: 'center' }}>
                  <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '8px' }}>
                      <button 
                        onClick={() => handleFacturar(p)}
                        style={{ 
                            background: esFacturado ? 'rgba(76, 175, 80, 0.15)' : 'transparent', 
                            color: '#69f0ae',
                            border: esFacturado ? '1px solid rgba(76, 175, 80, 0.3)' : '1px solid #69f0ae',
                            padding: '6px 12px', cursor: 'pointer', borderRadius: '6px',
                            fontSize: '0.75rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '5px',
                            transition: 'all 0.2s ease'
                        }}
                        onMouseOver={(e) => e.currentTarget.style.transform = 'translateY(-1px)'}
                        onMouseOut={(e) => e.currentTarget.style.transform = 'translateY(0)'}
                      >
                        {esFacturado ? ( <><span>‚¨á</span> PDF</> ) : ( <><span>üìÑ</span> FACTURAR</> )}
                      </button>

                      {esFacturado && (
                          <button
                            onClick={() => abrirModalAnular(p)} 
                            title="Anular factura y corregir"
                            style={{
                                background: 'transparent',
                                border: '1px solid rgba(255, 82, 82, 0.4)',
                                color: '#ff5252',
                                padding: '6px 10px', borderRadius: '6px', cursor: 'pointer',
                                fontSize: '0.75rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '4px',
                                transition: 'all 0.2s ease'
                            }}
                            onMouseOver={(e) => {
                                e.currentTarget.style.background = 'rgba(255, 82, 82, 0.1)';
                                e.currentTarget.style.borderColor = '#ff5252';
                            }}
                            onMouseOut={(e) => {
                                e.currentTarget.style.background = 'transparent';
                                e.currentTarget.style.borderColor = 'rgba(255, 82, 82, 0.4)';
                            }}
                          >
                              ‚ùå <span style={{fontSize: '0.7rem', opacity: 0.9}}>ANULAR</span>
                          </button>
                      )}
                  </div>
                </td>
                <td style={{ padding: '10px', textAlign: 'center' }}>
                  <button 
                    onClick={() => handleDespachar(p)}
                    disabled={!esFacturado}
                    style={{ 
                        background: 'transparent', 
                        color: esFacturado ? '#ff9800' : '#555', 
                        border: esFacturado ? '1px solid #ff9800' : '1px solid #555', 
                        padding: '6px 12px', cursor: esFacturado ? 'pointer' : 'not-allowed', 
                        borderRadius:'4px', fontSize: '0.8rem', transition: 'all 0.2s'
                    }}
                  >
                    üöö Despachar
                  </button>
                </td>
              </tr>
            )})}
          </tbody>
        </table>
      )}
    </div>
  );
}

export default AdminPedidos;
==================================================
ARCHIVO: .\frontend\src\components\AgregarProducto.jsx
==================================================
import React, { useState } from 'react';
// El CSS se carga globalmente o desde Admin.css importado en App, 
// pero las clases funcionar√°n igual.

function AgregarProducto() {
  const [nuevoProducto, setNuevoProducto] = useState({
    nombre: '',
    descripcion: '',
    precio: '',
    categoria: '',
    imagenUrl: '', // Corregido para coincidir con backend (antes dec√≠a imagen)
    stock: ''
  });

  const handleChange = (e) => {
    const { name, value } = e.target;
    setNuevoProducto(prev => ({ ...prev, [name]: value }));
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    
    // Validar tipos de datos antes de enviar
    const productoAEnviar = {
        ...nuevoProducto,
        precio: parseFloat(nuevoProducto.precio),
        stock: parseInt(nuevoProducto.stock)
    };

    fetch('http://localhost:8080/api/productos', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(productoAEnviar)
    })
      .then(res => {
        if (!res.ok) throw new Error('Error al agregar producto');
        return res.json();
      })
      .then(() => {
        alert('‚úÖ Producto agregado con √©xito');
        window.location.reload(); 
      })
      .catch(error => alert(error.message));
  };

  return (
    <div>
      {/* Usamos la clase admin-form definida en Admin.css */}
      <form onSubmit={handleSubmit} className="admin-form">
        <input type="text" name="nombre" placeholder="Nombre del Producto" value={nuevoProducto.nombre} onChange={handleChange} required />
        <input type="text" name="descripcion" placeholder="Descripci√≥n breve" value={nuevoProducto.descripcion} onChange={handleChange} required />
        <input type="number" name="precio" placeholder="Precio ($)" value={nuevoProducto.precio} onChange={handleChange} required />
        <input type="text" name="categoria" placeholder="Categor√≠a (ej: Teclados)" value={nuevoProducto.categoria} onChange={handleChange} required />
        <input type="text" name="imagenUrl" placeholder="URL de la Imagen" value={nuevoProducto.imagenUrl} onChange={handleChange} required />
        <input type="number" name="stock" placeholder="Cantidad de Stock" value={nuevoProducto.stock} onChange={handleChange} required />
        
        <button type="submit" className="btn-admin-submit">
            Guardar Producto
        </button>
      </form>
    </div>
  );
}

export default AgregarProducto;
==================================================
ARCHIVO: .\frontend\src\components\Carrito.css
==================================================
/* frontend/src/components/Carrito.css */

.carrito-container {
  text-align: center;
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #e0e0e0; /* Texto claro */
  max-width: 600px;
  margin: 0 auto;
}

.carrito-container h2 {
  margin-bottom: 20px;
  color: #00d2ff; /* T√≠tulo Ne√≥n */
  text-transform: uppercase;
  letter-spacing: 1px;
}

.carrito-vacio {
  background: rgba(255, 255, 255, 0.05);
  padding: 40px;
  border-radius: 10px;
  border: 1px dashed #555;
}

/* LISTA DE PRODUCTOS */
.carrito-lista {
  list-style: none;
  padding: 0;
  margin-bottom: 20px;
}

.carrito-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  /* Fondo semitransparente para que se lea sobre la imagen */
  background-color: rgba(30, 30, 40, 0.8); 
  border: 1px solid #444;
  
  margin: 10px 0;
  padding: 15px;
  border-radius: 8px;
  font-size: 1rem;
  box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}

.info-producto {
  text-align: left;
  display: flex;
  flex-direction: column;
}

.info-producto .nombre {
  font-weight: bold;
  color: #fff;
  font-size: 1.1rem;
}

.info-producto .precio {
  color: #00d2ff; /* Precio en cyan */
  font-size: 0.9rem;
  margin-top: 4px;
}

/* CONTROLES */
.controles-cantidad {
  display: flex;
  align-items: center;
  gap: 10px;
}

.cantidad {
  color: #ccc;
  font-weight: bold;
}

.btn-eliminar {
  background-color: #ff5252; /* Rojo suave */
  color: white;
  border: none;
  border-radius: 4px;
  width: 30px;
  height: 30px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  transition: background 0.2s;
}

.btn-eliminar:hover {
  background-color: #ff1744;
}

/* RESUMEN Y BOT√ìN FINAL */
.resumen-compra {
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid #444;
}

.resumen-compra h3 {
  color: #fff;
  font-size: 1.5rem;
  margin-bottom: 20px;
}

.btn-confirmar {
  padding: 12px 30px;
  font-size: 1rem;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  
  background: linear-gradient(45deg, #00d2ff, #007bff);
  color: white;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 0 15px rgba(0, 210, 255, 0.3);
  transition: transform 0.2s, box-shadow 0.2s;
}

.btn-confirmar:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 25px rgba(0, 210, 255, 0.6);
}
==================================================
ARCHIVO: .\frontend\src\components\Carrito.jsx
==================================================
import React from "react";
import "./Carrito.css";
import { useNavigate } from "react-router-dom";
import { FaTrash } from "react-icons/fa";
// Importamos el contexto
import { useNotification } from "../context/NotificationContext";

function Carrito({ carrito, restarDelCarrito, vaciarCarrito, usuario }) {
  
  const navigate = useNavigate();
  // Usamos la funci√≥n global
  const { mostrarNotificacion } = useNotification();

  const total = carrito.reduce((acc, item) => acc + (item.precio * item.cantidad), 0);

  const crearPedido = () => {
    // Validaci√≥n: Usuario
    if (!usuario) {
        mostrarNotificacion("üîí Inicia sesi√≥n para finalizar la compra");
        setTimeout(() => {
            navigate("/login");
        }, 2000);
        return;
    }

    // Validaci√≥n: Carrito vac√≠o
    if (carrito.length === 0) {
        mostrarNotificacion("‚ö†Ô∏è El carrito est√° vac√≠o");
        return;
    }

    const pedido = {
      usuarioId: usuario.username, 
      estado: "nuevo",
      lineas: carrito.map((item) => ({
        productoId: item.id,
        cantidad: item.cantidad,
      })),
    };

    fetch("http://localhost:8080/api/pedidos", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(pedido),
    })
      .then((res) => {
        if (!res.ok) throw new Error("Error al crear pedido");
        return res.json();
      })
      .then(() => {
        mostrarNotificacion("‚úÖ ¬°Pedido creado con √©xito!");
        vaciarCarrito(); 
        setTimeout(() => {
            navigate("/pedidos");
        }, 2000);
      })
      .catch((err) => {
        console.error("Error al crear pedido", err);
        mostrarNotificacion("‚ùå Error al procesar el pedido");
      });
  };

  return (
    <div className="carrito-container">
      <h2>üõí Tu Carrito de Compras</h2>

      {carrito.length === 0 ? (
        <div className="carrito-vacio">
            <p>No hay productos en el carrito.</p>
            <button className="btn-confirmar" style={{background: '#444', marginTop:'10px'}} onClick={() => navigate("/productos")}>
                Ir al Cat√°logo
            </button>
        </div>
      ) : (
        <div>
          <ul className="carrito-lista">
            {carrito.map((item) => (
              <li key={item.id} className="carrito-item">
                <div className="info-producto">
                    <span className="nombre">{item.nombre}</span>
                    <span className="precio">${item.precio}</span>
                </div>
                
                <div className="controles-cantidad">
                    <span className="cantidad">Cant: {item.cantidad}</span>
                    
                    <button 
                        className="btn-eliminar" 
                        onClick={() => restarDelCarrito(item.id)}
                        title="Eliminar del carrito"
                        style={{
                            background: 'transparent',
                            border: '1px solid #ff5252',
                            color: '#ff5252',
                            width: '35px',
                            height: '35px',
                            borderRadius: '6px',
                            cursor: 'pointer',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            transition: 'all 0.2s'
                        }}
                        onMouseOver={(e) => {
                            e.currentTarget.style.background = 'rgba(255, 82, 82, 0.2)';
                            e.currentTarget.style.transform = 'scale(1.1)';
                        }}
                        onMouseOut={(e) => {
                            e.currentTarget.style.background = 'transparent';
                            e.currentTarget.style.transform = 'scale(1)';
                        }}
                    >
                         <FaTrash size={16} />
                    </button>
                </div>
              </li>
            ))}
          </ul>
          
          <div className="resumen-compra">
            <h3>Total: ${total}</h3>
            <button className="btn-confirmar" onClick={crearPedido}>
                Confirmar Pedido
            </button>
          </div>
        </div>
      )}
    </div>
  );
}

// ESTA ES LA L√çNEA QUE FALTABA Y CAUSABA EL ERROR:
export default Carrito;
==================================================
ARCHIVO: .\frontend\src\components\Categorias.css
==================================================
.categorias-container {
  padding: 40px 20px;
  text-align: center;
  background-color: #f4f4f9;
  min-height: 80vh;
}

.categorias-container h2 {
  font-size: 2.5rem;
  color: #333;
  margin-bottom: 10px;
}

.categorias-container p {
  color: #666;
  margin-bottom: 40px;
  font-size: 1.1rem;
}

.categorias-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 30px;
  max-width: 1000px;
  margin: 0 auto;
}

.categoria-card {
  background: white;
  border-radius: 15px;
  padding: 30px;
  text-decoration: none;
  color: #333;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  border: 1px solid #eee;
}

.categoria-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 15px 30px rgba(0,0,0,0.15);
  border-color: #00d2ff;
}

.icon-container {
  background-color: #e0f7fa;
  color: #00bcd4;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
}

.categoria-card h3 {
  font-size: 1.5rem;
  margin: 0;
  text-transform: capitalize;
}

.ver-mas {
  font-size: 0.9rem;
  color: #00bcd4;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 5px;
  margin-top: auto; /* Empuja el link hacia abajo si hay espacio */
}
==================================================
ARCHIVO: .\frontend\src\components\Categorias.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { FaTags, FaArrowRight } from 'react-icons/fa'; // ‚úÖ Importaci√≥n corregida (FaTags)
import './Categorias.css';

const Categorias = () => {
  const [categorias, setCategorias] = useState([]);

  useEffect(() => {
    // Obtenemos los productos para extraer sus categor√≠as √∫nicas
    fetch('http://localhost:8080/api/productos')
      .then(res => res.json())
      .then(data => {
        // Extraemos las categor√≠as √∫nicas usando Set
        // Si un producto no tiene categor√≠a, le ponemos "General"
        const uniqueCats = [...new Set(data.map(p => p.categoria || 'General'))];
        setCategorias(uniqueCats);
      })
      .catch(err => console.error("Error cargando categor√≠as:", err));
  }, []);

  return (
    <div className="categorias-container">
      <h2>Explora nuestro Cat√°logo</h2>
      <p>Encuentra justo lo que necesitas para tu setup</p>
      
      <div className="categorias-grid">
        {categorias.map((cat, index) => (
          <Link to={`/productos?categoria=${cat}`} key={index} className="categoria-card">
            <div className="icon-container">
              <FaTags /> {/* ‚úÖ Componente corregido */}
            </div>
            <h3>{cat}</h3>
            <span className="ver-mas">
              Ver productos <FaArrowRight />
            </span>
          </Link>
        ))}
      </div>
    </div>
  );
};

export default Categorias;
==================================================
ARCHIVO: .\frontend\src\components\Inicio.css
==================================================
/* --- 1. ESTRUCTURA PRINCIPAL Y FONDO --- */
.inicio-container {
  width: 100%;
  height: 100vh;
  background: radial-gradient(circle at center, #2b2b3d 0%, #000000 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

/* --- 2. SECCI√ìN CENTRAL (CONTENIDO) --- */
.hero-section {
  position: relative;
  z-index: 2;
  text-align: center;
  color: white;
  max-width: 800px;
  padding: 40px;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 20px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
}

/* --- 3. LOGO REDONDO NE√ìN --- */
.logo-container img {
  width: 160px; /* Un pel√≠n m√°s chico para equilibrar */
  height: 160px;
  object-fit: cover;
  border-radius: 50%;
  border: 3px solid #00d2ff; 
  box-shadow: 0 0 25px rgba(0, 210, 255, 0.5), 
              inset 0 0 15px rgba(0, 0, 0, 0.5);
  margin-bottom: 25px;
  animation: flotar 6s ease-in-out infinite;
}

/* --- 4. TIPOGRAF√çA --- */
.titulo-principal {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 3rem; /* Ajustado levemente */
  font-weight: 800;
  margin-bottom: 10px;
  text-transform: uppercase;
  letter-spacing: 2px;
  text-shadow: 0 0 10px rgba(0, 210, 255, 0.4);
}

.subtitulo {
  font-size: 1.1rem;
  color: #aaa;
  margin-bottom: 35px;
  font-weight: 300;
}

/* --- 5. BOTONES DE ACCI√ìN --- */
.botones-accion {
  display: flex;
  justify-content: center;
  gap: 20px;
}

button {
  font-size: 0.95rem;
  font-weight: bold;
  padding: 10px 30px;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.btn-catalogo {
  background: linear-gradient(45deg, #00d2ff, #007bff);
  color: #fff;
  box-shadow: 0 0 15px rgba(0, 210, 255, 0.3);
}

.btn-catalogo:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 25px rgba(0, 210, 255, 0.6);
}

.btn-carrito {
  background: transparent;
  border: 1px solid #00d2ff; /* Borde m√°s fino */
  color: #00d2ff;
}

.btn-carrito:hover {
  background: rgba(0, 210, 255, 0.1);
  transform: translateY(-2px);
}

/* --- 6. ANIMACIONES --- */
@keyframes flotar {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-8px); }
  100% { transform: translateY(0px); }
}

/* =========================================
   ALERTA FLOTANTE (VERSI√ìN SUAVE)
   ========================================= */

.alerta-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8); /* Un poco menos oscuro */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  backdrop-filter: blur(5px);
}

.alerta-neon-flotante {
  /* Fondo m√°s limpio */
  background: #1a1a24; 
  padding: 30px; /* Menos relleno = m√°s compacto */
  border-radius: 20px; /* Bordes redondeados modernos */
  
  text-align: center;
  color: white;
  
  /* Tama√±o controlado */
  width: 400px; 
  max-width: 90%;

  /* Borde fino y sombra suave */
  border: 1px solid rgba(0, 210, 255, 0.3);
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.5); /* Sombra negra para profundidad */
  
  animation: aparecerSuave 0.3s ease-out;
}

.alerta-neon-flotante h3 {
  font-size: 1.4rem;
  margin-top: 0;
  margin-bottom: 10px;
  color: #00d2ff; /* Solo el t√≠tulo tiene color */
}

.alerta-neon-flotante p {
  font-size: 1rem;
  color: #ccc;
  margin-bottom: 25px;
  line-height: 1.5;
}

/* Bot√≥n de la alerta (Estilo armonioso) */
.btn-alerta {
  background: #00d2ff;
  color: #000; /* Texto negro para leer mejor */
  box-shadow: none; /* Sin brillo excesivo */
  width: 100%; /* Bot√≥n ancho se ve bien en modales */
}

.btn-alerta:hover {
  background: #33ddff;
  transform: scale(1.02);
}

/* Animaci√≥n sutil */
@keyframes aparecerSuave {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
==================================================
ARCHIVO: .\frontend\src\components\Inicio.jsx
==================================================
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import './Inicio.css'; 

function Inicio({ usuario }) {
  const navigate = useNavigate();

  return (
    <div className="inicio-container">
      
      {/* Ya no necesitamos la alerta flotante compleja, porque el bot√≥n llevar√° al login directamente */}

      <div className="hero-section">
        <div className="logo-container">
           <img src="/logo.jpg" alt="Logo Tienda Gamer" />
        </div>
        <h1 className="titulo-principal">Tienda de Insumos Inform√°ticos</h1>
        <p className="subtitulo">
            {usuario 
              ? "Bienvenido de nuevo. Tu setup te espera." 
              : "Inicia sesi√≥n para acceder a nuestro cat√°logo exclusivo."}
        </p>
        
        <div className="botones-accion">
          {usuario ? (
            // --- VERSI√ìN LOGUEADO ---
            <>
                <button className="btn-catalogo" onClick={() => navigate('/productos')}>
                    üì¶ Ir al Cat√°logo
                </button>
                <button className="btn-carrito" onClick={() => navigate('/carrito')}>
                    üõí Mi Carrito
                </button>
            </>
          ) : (
            // --- VERSI√ìN INVITADO (GUEST) ---
            <button 
                className="btn-catalogo" 
                onClick={() => navigate('/login')}
                style={{ padding: '15px 40px', fontSize: '1.2rem' }} // Un poco m√°s grande para llamar la atenci√≥n
            >
                üîë Iniciar Sesi√≥n para Comprar
            </button>
          )}
        </div>
      </div>
    </div>
  );
}

export default Inicio;
==================================================
ARCHIVO: .\frontend\src\components\Login.jsx
==================================================
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';

function Login({ onLogin }) {
  // Estado para saber si el usuario quiere LOGIN o REGISTRO
  const [esRegistro, setEsRegistro] = useState(false);
  
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  const navigate = useNavigate();

  const handleSubmit = (e) => {
    e.preventDefault();
    setError('');

    // 1. DETERMINAR URL SEG√öN EL MODO
    const url = esRegistro 
      ? 'http://localhost:8080/api/auth/registro' 
      : 'http://localhost:8080/api/auth/login';

    // 2. PREPARAR DATOS
    const payload = { username, password };
    // Si es registro, aseguramos que el rol sea USER por defecto
    if(esRegistro) payload.rol = 'USER';

    fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    })
    .then(async res => {
      // Si el backend responde con error (ej: 400 o 500), lanzamos excepci√≥n
      if (!res.ok) {
          const text = await res.text();
          throw new Error(text || "Error en la operaci√≥n");
      }
      return res.json();
    })
    .then(data => {
      if (esRegistro) {
        // --- CASO REGISTRO EXITOSO ---
        alert("‚úÖ ¬°Cuenta creada con √©xito! Ahora inicia sesi√≥n.");
        setEsRegistro(false); // Volvemos al modo login
        setPassword('');      // Limpiamos pass
      } else {
        // --- CASO LOGIN EXITOSO ---
        onLogin(data); // Actualizamos el estado global en App.jsx
        
        // Redirecci√≥n seg√∫n rol
        if (data.rol === 'ADMIN') {
          navigate('/gestion');
        } else {
          navigate('/productos');
        }
      }
    })
    .catch(err => {
      console.error(err);
      // Mostramos el mensaje limpio al usuario
      setError(esRegistro ? "Error: El usuario quiz√°s ya existe." : "Usuario o contrase√±a incorrectos.");
    });
  };

  const handleOlvidePassword = (e) => {
      e.preventDefault();
      // Como no tenemos servidor de correo real, mostramos un aviso simulado
      alert("üîí Para recuperar tu contrase√±a, por favor contacta a soporte@utnstore.com o pide al administrador que restablezca tu cuenta.");
  };

  return (
    <div style={{ 
        maxWidth: '400px', 
        margin: '60px auto', 
        padding: '30px', 
        borderRadius: '10px',
        boxShadow: '0 4px 20px rgba(0,0,0,0.1)',
        backgroundColor: 'white',
        textAlign: 'center'
    }}>
      
      <h2 style={{ color: '#333', marginBottom: '20px' }}>
          {esRegistro ? "Crear Cuenta" : "Bienvenido"}
      </h2>

      {error && (
        <div style={{ 
            backgroundColor: '#ffdddd', 
            color: '#d8000c', 
            padding: '10px', 
            borderRadius: '5px',
            marginBottom: '15px',
            fontSize: '0.9rem'
        }}>
            {error}
        </div>
      )}

      <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>
        <input 
          type="text" 
          placeholder="Nombre de Usuario" 
          value={username} 
          onChange={(e) => setUsername(e.target.value)} 
          required 
          style={{ 
              padding: '12px', 
              borderRadius: '5px', 
              border: '1px solid #ccc',
              fontSize: '1rem' 
          }}
        />
        <input 
          type="password" 
          placeholder="Contrase√±a" 
          value={password} 
          onChange={(e) => setPassword(e.target.value)} 
          required 
          style={{ 
              padding: '12px', 
              borderRadius: '5px', 
              border: '1px solid #ccc',
              fontSize: '1rem' 
          }}
        />
        
        <button 
            type="submit" 
            style={{ 
                padding: '12px', 
                backgroundColor: esRegistro ? '#28a745' : '#007bff', 
                color: 'white', 
                border: 'none', 
                borderRadius: '5px',
                cursor: 'pointer',
                fontWeight: 'bold',
                fontSize: '1rem',
                transition: 'background 0.3s'
            }}
        >
          {esRegistro ? "Registrarme" : "Ingresar"}
        </button>
      </form>

      {/* --- ENLACES DE AYUDA --- */}
      <div style={{ marginTop: '20px', fontSize: '0.9rem', display: 'flex', flexDirection: 'column', gap: '10px' }}>
          
          {/* Toggle entre Login y Registro */}
          <div>
            {esRegistro ? "¬øYa tienes cuenta? " : "¬øNo tienes cuenta? "}
            <button 
                onClick={() => { setEsRegistro(!esRegistro); setError(''); }}
                style={{ 
                    background: 'none', 
                    border: 'none', 
                    color: '#007bff', 
                    cursor: 'pointer', 
                    textDecoration: 'underline',
                    fontWeight: 'bold',
                    fontSize: 'inherit'
                }}
            >
                {esRegistro ? "Inicia Sesi√≥n" : "Reg√≠strate aqu√≠"}
            </button>
          </div>

          {/* Olvid√© contrase√±a (solo visible en Login) */}
          {!esRegistro && (
              <a href="#" onClick={handleOlvidePassword} style={{ color: '#666', textDecoration: 'none', fontSize: '0.85rem' }}>
                  ¬øOlvidaste tu contrase√±a?
              </a>
          )}

      </div>
    </div>
  );
}

export default Login;
==================================================
ARCHIVO: .\frontend\src\components\Navbar.css
==================================================
.navbar {
  background-color: #333;
  padding: 10px 0;
}

.navbar ul {
  list-style: none;
  display: flex;
  justify-content: space-around;
  align-items: center;
  margin: 0;
  padding: 0;
}

.navbar li a {
  color: white;
  text-decoration: none;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 10px;
  transition: background-color 0.3s ease;
}

.navbar li a:hover {
  background-color: #444;
  border-radius: 5px;
}
.cart-badge {
  background-color: #ff4444;
  color: white;
  border-radius: 50%;
  padding: 2px 6px;
  font-size: 0.8rem;
  font-weight: bold;
  min-width: 15px;
  text-align: center;
}

==================================================
ARCHIVO: .\frontend\src\components\Navbar.jsx
==================================================
import React from 'react';
import { Link, useNavigate } from 'react-router-dom';
import './Navbar.css';

function Navbar({ usuario, onLogout, carrito, busqueda, setBusqueda }) {
  const navigate = useNavigate();

  const handleSalir = () => {
    onLogout();
    navigate('/');
  };

  const cantidadTotal = carrito ? carrito.reduce((acc, item) => acc + item.cantidad, 0) : 0;

  return (
    <nav className="navbar">
      <ul>
        {/* Siempre visible: Inicio */}
        <li><Link to="/">üè† Inicio</Link></li>
        
        {/* --- SOLO VISIBLE SI HAY USUARIO --- */}
        {usuario && (
          <>
            <li><Link to="/productos">üì¶ Cat√°logo</Link></li>

            {/* BARRA DE B√öSQUEDA (Solo para usuarios) */}
            <li style={{ flexGrow: 1, margin: '0 20px', maxWidth: '400px' }}>
              <input 
                type="text"
                placeholder="üîç Buscar producto..."
                value={busqueda}
                onChange={(e) => {
                    setBusqueda(e.target.value);
                    navigate('/productos');
                }}
                style={{
                    width: '100%',
                    padding: '8px',
                    borderRadius: '20px',
                    border: 'none',
                    outline: 'none'
                }}
              />
            </li>

            <li>
              <Link to="/carrito" style={{ display: 'flex', alignItems: 'center', gap: '5px' }}>
                üõí <span className="cart-badge">{cantidadTotal}</span>
              </Link>
            </li>
            
            <li><Link to="/pedidos">üìÑ Mis Pedidos</Link></li>
          </>
        )}

        {/* --- LADO DERECHO (LOGIN / LOGOUT) --- */}
        {usuario ? (
          <>
            {usuario.rol === 'ADMIN' && (
              <li style={{ marginLeft: '20px', borderLeft:'1px solid #555', paddingLeft:'20px' }}>
                  <Link to="/gestion" style={{ color: '#ffca28' }}>‚öôÔ∏è Gesti√≥n</Link>
              </li>
            )}
            
            <li style={{ marginLeft: 'auto' }}>
              <span style={{ color: 'white', marginRight: '10px' }}>Hola, {usuario.username}</span>
              <button onClick={handleSalir} style={{ background: 'transparent', border: '1px solid white', color: 'white', cursor: 'pointer', padding:'2px 8px', borderRadius:'4px' }}>
                Salir
              </button>
            </li>
          </>
        ) : (
          <li style={{ marginLeft: 'auto' }}>
            <Link to="/login" style={{ backgroundColor: '#007bff', padding: '5px 10px', borderRadius: '4px', color: 'white', textDecoration: 'none' }}>
              üîë Iniciar Sesi√≥n
            </Link>
          </li>
        )}
      </ul>
    </nav>
  );
}

export default Navbar;
==================================================
ARCHIVO: .\frontend\src\components\Pedidos.jsx
==================================================
import React, { useEffect, useState } from "react";

function Pedidos() {
  const [pedidos, setPedidos] = useState([]);

  useEffect(() => {
    fetch("http://localhost:8080/api/pedidos")
      .then((res) => res.json())
      .then((data) => {
        console.log("Pedidos recibidos:", data);  // Para debug
        setPedidos(data);
      })
      .catch((err) => {
        console.error("Error al obtener pedidos:", err);
        alert("Error al obtener pedidos");
      });
  }, []);

  return (
    <div>
      <h2>Historial de Pedidos</h2>
      {pedidos.length === 0 ? (
        <p>No hay pedidos a√∫n.</p>
      ) : (
        pedidos.map((pedido) => (
          <div key={pedido.id} style={{ border: "1px solid #ccc", margin: "20px", padding: "10px" }}>
            <h4>Pedido #{pedido.id}</h4>
            <p>Fecha: {new Date(pedido.fecha).toLocaleString()}</p>
            <p>Estado: {pedido.estado}</p>
            <p>Total: ${pedido.total.toFixed(2)}</p>

            <table style={{ width: "100%", borderCollapse: "collapse" }}>
              <thead>
                <tr>
                  <th style={{ border: "1px solid black" }}>Producto</th>
                  <th style={{ border: "1px solid black" }}>Cantidad</th>
                  <th style={{ border: "1px solid black" }}>Precio Unitario</th>
                  <th style={{ border: "1px solid black" }}>Subtotal</th>
                </tr>
              </thead>
              <tbody>
                {pedido.lineas.map((linea, index) => (
                  <tr key={index}>
                    <td style={{ border: "1px solid black" }}>{linea.productoNombre}</td>
                    <td style={{ border: "1px solid black" }}>{linea.cantidad}</td>
                    <td style={{ border: "1px solid black" }}>${linea.productoPrecio?.toFixed(2)}</td>
                    <td style={{ border: "1px solid black" }}>${(linea.productoPrecio * linea.cantidad).toFixed(2)}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ))
      )}
    </div>
  );
}

export default Pedidos;
==================================================
ARCHIVO: .\frontend\src\components\ProductoList.css
==================================================
.tabla-productos {
  width: 100%;
  max-width: 1000px;
  margin: 20px auto;
  border-collapse: collapse;
  font-family: 'Segoe UI', sans-serif;
  background-color: #23232e; 
  color: #cfcfcf; 
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
}

.tabla-productos th,
.tabla-productos td {
  border-bottom: 1px solid #333;
  padding: 15px;
  text-align: center;
  vertical-align: middle; /* Alinea verticalmente los inputs */
}

.tabla-productos th {
  background-color: #2b2b36; 
  color: #82b1ff; 
  text-transform: uppercase;
  font-size: 0.85rem;
  letter-spacing: 1px;
  font-weight: 600;
}

.tabla-productos tr:last-child td { border-bottom: none; }
.tabla-productos tr:hover { background-color: #2d2d3b; }

/* INPUTS PARA EDITAR */
.tabla-productos input {
  background: #1a1a24;
  border: 1px solid #555;
  color: #fff;
  padding: 8px;
  border-radius: 4px;
  text-align: center;
}

.tabla-productos input:focus {
  border-color: #82b1ff;
  outline: none;
}

/* BOTONES */
button {
  margin: 0 4px;
  padding: 8px 12px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.9rem;
  transition: all 0.2s;
}

/* --- CAMBIO DE COLOR DEL BOT√ìN ELIMINAR --- */
.btn-eliminar {
  /* Rojo ladrillo suave / Pastel */
  background-color: #a64444; 
  color: white;
}

.btn-eliminar:hover {
  /* Un poco m√°s vivo al pasar el mouse, pero sin quemar la retina */
  background-color: #c55555; 
  transform: scale(1.05);
}

/* --- NOTIFICACI√ìN FLOTANTE (CENTRADA) --- */
.notificacion-oval {
  position: fixed;
  top: 50%;              /* Centrado Vertical */
  left: 50%;             /* Centrado Horizontal */
  transform: translate(-50%, -50%); /* Ajuste exacto al centro */
  
  background-color: rgba(30, 30, 40, 0.98); /* Fondo oscuro s√≥lido */
  color: #82b1ff;        /* Azul Pastel */
  border: 2px solid #82b1ff; /* Borde un poquito m√°s grueso */
  
  padding: 25px 60px;    /* M√°s grande para que se lea bien en el centro */
  border-radius: 50px;   
  
  font-family: 'Segoe UI', sans-serif;
  font-weight: bold;
  font-size: 1.2rem;     /* Letra m√°s grande */
  text-align: center;
  
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.7); /* Sombra intensa para destacar */
  z-index: 9999;
  
  /* Animaci√≥n de "Zoom" con rebote suave */
  animation: aparecerCentro 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Animaci√≥n: Empieza peque√±o y crece */
@keyframes aparecerCentro {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}
/* =========================================
   MODAL DE IMAGEN (MEJORADO - GRANDE Y LIMPIO)
   ========================================= */

/* 1. EL FONDO DE LA PANTALLA (OSCURO) */
.modal-imagen-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.90); /* Negro casi total, muy elegante */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  backdrop-filter: blur(8px); /* Blur fuerte al fondo */
  animation: aparecerSuave 0.2s ease-out;
}

/* 2. EL CONTENEDOR DE LA IMAGEN (SIN FONDO AZUL) */
.modal-imagen-contenido {
  position: relative;
  /* Quitamos cualquier background-color para que no se vea azul */
  background: transparent; 
  box-shadow: none; 
  border: none;
  
  /* Permitimos que crezca */
  max-width: 95vw; /* 95% del ancho de pantalla */
  max-height: 95vh; /* 95% del alto de pantalla */
  
  display: flex;
  justify-content: center;
  align-items: center;
}

/* 3. LA IMAGEN EN S√ç (GIGANTE) */
.modal-imagen-contenido img {
  width: auto; 
  height: auto;
  
  /* Esto asegura que la imagen sea lo m√°s grande posible sin salirse de la pantalla */
  max-width: 90vw;
  max-height: 90vh;
  
  object-fit: contain;
  border-radius: 8px;
  box-shadow: 0 0 50px rgba(0, 0, 0, 0.8); /* Sombra para que "flote" */
}

/* 4. EL BOT√ìN CERRAR (FLOTANTE Y MODERNO) */
.cerrar-modal {
  position: absolute;
  top: -40px;   /* Lo sacamos un poco hacia arriba de la imagen */
  right: -40px; /* Lo sacamos hacia la derecha */
  
  color: white;
  background-color: rgba(255, 255, 255, 0.1); /* C√≠rculo sutil */
  width: 40px;
  height: 40px;
  border-radius: 50%;
  
  display: flex;
  justify-content: center;
  align-items: center;
  
  font-size: 24px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 10001;
}

.cerrar-modal:hover {
  background-color: #ff5252; /* Rojo al pasar el mouse */
  color: white;
  transform: rotate(90deg); /* Peque√±a animaci√≥n al tocar */
}

/* Animaci√≥n de entrada */
@keyframes aparecerSuave {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}
==================================================
ARCHIVO: .\frontend\src\components\ProductoList.jsx
==================================================
import React, { useEffect, useState } from "react";
import "./ProductoList.css";
// 1. IMPORTAMOS EL HOOK DEL CONTEXTO
import { useNotification } from "../context/NotificationContext";

function ProductoList({ agregarAlCarrito, esAdmin, busqueda }) {
  const [productos, setProductos] = useState([]);
  
  // 2. OBTENEMOS LA FUNCI√ìN GLOBAL PARA MOSTRAR MENSAJES
  const { mostrarNotificacion } = useNotification();

  // ESTADOS PARA EDICI√ìN
  const [productoEditando, setProductoEditando] = useState(null);
  const [datosEditados, setDatosEditados] = useState({});

  // (El estado local de mensajeAlerta LO BORRAMOS, ya no se usa)

  // ESTADOS PARA EL MODAL DE IMAGEN 
  const [imagenModal, setImagenModal] = useState(null);  
  const [zoom, setZoom] = useState(1); 

  useEffect(() => {
    fetch("http://localhost:8080/api/productos")
      .then((res) => res.ok ? res.json() : [])
      .then((data) => {
        if (Array.isArray(data)) setProductos(data);
      })
      .catch((error) => console.error("Error:", error));
  }, []);

  // --- FUNCIONES DEL MODAL DE IMAGEN ---
  const abrirModal = (url) => {
      if (url) {
          setImagenModal(url);
          setZoom(1); 
      }
  };

  const cerrarModal = () => {
      setImagenModal(null);
  };

  // L√≥gica de filtrado
  const listaSegura = Array.isArray(productos) ? productos : [];
  const productosVisibles = listaSegura.filter((p) => {
    if (busqueda && !p.nombre.toLowerCase().includes(busqueda.toLowerCase())) return false;
    return true;
  });

  // --- NUEVA FUNCI√ìN PARA AGREGAR AL CARRITO CON NOTIFICACI√ìN ---
  const handleAgregar = (p) => {
    // 1. Ejecutamos la l√≥gica del carrito (que viene de App.jsx)
    agregarAlCarrito(p);
    // 2. Disparamos la notificaci√≥n global bonita
    mostrarNotificacion(`‚úÖ ${p.nombre} agregado al carrito`);
  };

  // --- FUNCIONES ADMIN ---
  const handleEliminar = (id) => {
    if(window.confirm("¬øSeguro que deseas eliminar este producto?")) {
        fetch(`http://localhost:8080/api/productos/${id}`, {method:"DELETE"})
        .then(() => {
            setProductos(prev => prev.filter(p => p.id !== id));
            // Usamos la notificaci√≥n global
            mostrarNotificacion("üóëÔ∏è Producto eliminado correctamente");
        })
        .catch(err => mostrarNotificacion("‚ùå Error al eliminar"));
    }
  };

  const handleEditar = (p) => { 
      setProductoEditando(p.id); 
      setDatosEditados({...p}); 
  };

  const handleCancelar = () => setProductoEditando(null);

  const handleGuardar = () => {
    const payload = {
        ...datosEditados,
        precio: parseFloat(datosEditados.precio),
        stock: parseInt(datosEditados.stock)
    };

    fetch(`http://localhost:8080/api/productos/${productoEditando}`, {
      method: "PUT", 
      headers:{"Content-Type":"application/json"}, 
      body:JSON.stringify(payload)
    })
    .then(res => {
        if(!res.ok) throw new Error("Error en la respuesta");
        return res.json();
    })
    .then((productoActualizado) => {
        setProductos(prev => prev.map(p => 
            p.id === productoEditando ? productoActualizado : p
        ));
        setProductoEditando(null);
        mostrarNotificacion("‚úÖ ¬°Cambios guardados con √©xito!");
    })
    .catch(err => mostrarNotificacion("‚ùå Error: " + err.message));
  };

  const handleCambioCampo = (e) => {
      setDatosEditados({...datosEditados, [e.target.name]:e.target.value});
  };

  return (
    <div>
      {/* YA NO RENDERIZAMOS 'mensajeAlerta' AQU√ç, LO HACE EL CONTEXTO EN APP.JSX */}

      {/* --- MODAL DE IMAGEN CON ZOOM --- */}
      {imagenModal && (
        <div className="modal-imagen-backdrop" onClick={cerrarModal}>
            <div 
                className="modal-imagen-contenido" 
                onClick={(e) => e.stopPropagation()} 
                onWheel={(e) => {
                    e.stopPropagation(); 
                    const delta = e.deltaY * -0.001; 
                    const nuevoZoom = Math.min(Math.max(zoom + delta, 0.5), 5); 
                    setZoom(nuevoZoom);
                }}
            >
                <span className="cerrar-modal" onClick={cerrarModal}>&times;</span>
                <img 
                    src={imagenModal} 
                    alt="Producto grande" 
                    style={{ 
                        transform: `scale(${zoom})`, 
                        transition: 'transform 0.1s ease-out', 
                        cursor: 'zoom-in' 
                    }}
                />
            </div>
        </div>
      )}
      {!esAdmin && (
          <h2 style={{color:'#fff'}}>
             {busqueda ? `Resultados para: "${busqueda}"` : "Cat√°logo Completo"}
          </h2>
      )}
      
      {productosVisibles.length === 0 ? (
        <p style={{ marginTop: '20px', color: '#999' }}>No se encontraron productos.</p>
      ) : (
        <table className="tabla-productos">
          <thead>
            <tr>
              <th>Imagen</th>
              <th>Producto</th>
              <th>Precio</th>
              <th>Cat</th>
              <th>Stock</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {productosVisibles.map((p) => (
              <tr key={p.id}>
                <td>
                    {esAdmin && productoEditando === p.id ? (
                        <input 
                            type="text" 
                            name="imagenUrl" 
                            value={datosEditados.imagenUrl || ''} 
                            onChange={handleCambioCampo}
                            placeholder="/img/..."
                            style={{width:'80px', fontSize:'0.8rem'}}
                        />
                    ) : (
                        p.imagenUrl ? (
                            <img 
                                src={p.imagenUrl} 
                                alt="min" 
                                onError={(e) => e.target.src = 'https://via.placeholder.com/40?text=X'}
                                onClick={() => abrirModal(p.imagenUrl)} 
                                style={{
                                    width:'40px', 
                                    height:'40px', 
                                    objectFit:'cover', 
                                    borderRadius:'4px',
                                    cursor: 'pointer' 
                                }}
                            />
                        ) : 'üì∑'
                    )}
                </td>
                <td>
                  {esAdmin && productoEditando === p.id ? 
                    <input type="text" name="nombre" value={datosEditados.nombre} onChange={handleCambioCampo}/> : 
                    <strong>{p.nombre}</strong>
                  }
                </td>
                <td>
                   {esAdmin && productoEditando === p.id ? 
                    <input type="number" name="precio" value={datosEditados.precio} onChange={handleCambioCampo} style={{width:'80px'}}/> : 
                    `$${p.precio}`
                  }
                </td>
                <td>
                   {esAdmin && productoEditando === p.id ? 
                    <input type="text" name="categoria" value={datosEditados.categoria} onChange={handleCambioCampo} style={{width:'100px'}}/> : 
                    p.categoria
                  }
                </td>
                <td>
                   {esAdmin && productoEditando === p.id ? 
                     <input type="number" name="stock" value={datosEditados.stock} onChange={handleCambioCampo} style={{width:'60px'}}/> : 
                     <span style={{color: p.stock === 0 ? '#ff6b6b' : '#69db7c', fontWeight:'bold'}}>
                       {p.stock}
                     </span>
                   }
                </td>
                <td>
                  {esAdmin ? (
                    productoEditando === p.id ? 
                    <>
                        <button onClick={handleGuardar} style={{backgroundColor:'#4dabf7', color:'white'}}>üíæ</button>
                        <button onClick={handleCancelar} style={{backgroundColor:'#e0e0e0', color:'#333'}}>‚úñ</button>
                    </> 
                    :
                    <>
                        <button onClick={()=>handleEditar(p)} style={{backgroundColor:'#333', border:'1px solid #555', color:'white'}}>‚úèÔ∏è</button>
                        <button className="btn-eliminar" onClick={()=>handleEliminar(p.id)}>üóëÔ∏è</button>
                    </>
                  ) : (
                    <button
                      onClick={() => handleAgregar(p)} // <--- AQU√ç LLAMAMOS A LA NUEVA FUNCI√ìN
                      disabled={p.stock === 0}
                      style={{ 
                        backgroundColor: p.stock === 0 ? "#444" : "#007bff", 
                        color: "white", 
                        width: "100%",
                        opacity: p.stock === 0 ? 0.6 : 1,
                        cursor: p.stock === 0 ? "not-allowed" : "pointer"
                      }}
                    >
                      {p.stock === 0 ? "Sin Stock" : "üõí Agregar"}
                    </button>
                  )}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )}
    </div>
  );
}

export default ProductoList;
==================================================
ARCHIVO: .\frontend\src\context\NotificationContext.jsx
==================================================
import React, { createContext, useState, useContext } from 'react';
import '../components/Admin.css'; // Importamos el CSS donde est√° .notificacion-oval

const NotificationContext = createContext();

export const NotificationProvider = ({ children }) => {
  const [mensaje, setMensaje] = useState(null);

  const mostrarNotificacion = (texto) => {
    setMensaje(texto);
    setTimeout(() => {
      setMensaje(null);
    }, 3000);
  };

  return (
    <NotificationContext.Provider value={{ mostrarNotificacion }}>
      {children}
      {/* Aqu√≠ renderizamos la notificaci√≥n para TODA la app */}
      {mensaje && (
        <div className="notificacion-oval" style={{ zIndex: 99999 }}>
          {mensaje}
        </div>
      )}
    </NotificationContext.Provider>
  );
};

export const useNotification = () => useContext(NotificationContext);
==================================================
ARCHIVO: .\frontend\src\utils\facturaPDF.js
==================================================
import jsPDF from "jspdf";
import autoTable from "jspdf-autotable";

export const generarFacturaPDF = (pedido) => {
  try {
    const doc = new jsPDF();

    // --- COLORES CORPORATIVOS (Extra√≠dos de tu CSS) ---
    const azulCorporativo = [41, 128, 185]; 
    const colorNeon = [0, 210, 255];      // #00d2ff (Tu color principal de Inicio.css)
    const fondoOscuro = [43, 43, 61];     // #2b2b3d (Fondo del gradiente de Inicio)
    const grisOscuro = [44, 62, 80];
    const grisClaro = [245, 245, 245];

    // ==========================================
    // 1. ENCABEZADO (ESTILO GAMER/TECH)
    // ==========================================
    
    // --- LOGO CIRCULAR VECTORIAL ---
    // Recreamos el estilo visual de tu logo sin depender de la imagen externa
    
    // 1. C√≠rculo de fondo oscuro
    doc.setFillColor(...fondoOscuro);
    doc.setDrawColor(...colorNeon); // Borde color Ne√≥n
    doc.setLineWidth(1.5);          // Borde un poco m√°s grueso para que destaque
    doc.circle(25, 26, 12, "FD");   // F=Fill (Relleno), D=Draw (Borde)

    // 2. Texto "UTN" y "STORE" dentro del c√≠rculo
    doc.setTextColor(255, 255, 255); // Blanco
    doc.setFont("helvetica", "bold");
    doc.setFontSize(14);
    doc.text("UTN", 25, 29, { align: "center" }); // Centrado

    doc.setFontSize(6);
    doc.setTextColor(...colorNeon); // La palabra STORE en Ne√≥n
    doc.text("STORE", 25, 33, { align: "center" });

    // --- DATOS DE LA EMPRESA ---
    doc.setTextColor(...grisOscuro);
    doc.setFontSize(20);
    doc.text("UTN Computer Store", 45, 22); // Ajustado X para no pisar el logo

    doc.setFontSize(9);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(100);
    doc.text("Av. Tecnolog√≠a 1234, Ciudad Digital", 45, 28);
    doc.text("IVA Responsable Inscripto", 45, 33);
    doc.text("CUIT: 30-11223344-9", 45, 38);
    doc.text("www.utnstore.com", 45, 43);

    // --- CAJA DE INFO FACTURA (Derecha) ---
    doc.setDrawColor(200);
    doc.setLineWidth(0.1); // Volvemos a l√≠nea fina
    doc.setFillColor(...grisClaro);
    doc.roundedRect(130, 15, 70, 32, 2, 2, "FD");

    doc.setFontSize(14);
    doc.setTextColor(...azulCorporativo);
    doc.setFont("helvetica", "bold");
    doc.text("FACTURA B", 165, 24, { align: "center" });

    doc.setFontSize(10);
    doc.setTextColor(0);
    doc.text(`N¬∞ 0001-${pedido.id ? pedido.id.substring(0, 8).toUpperCase() : '000000'}`, 135, 33);
    doc.text(`Fecha: ${new Date().toLocaleDateString()}`, 135, 40);

    // ==========================================
    // 2. DATOS DEL CLIENTE
    // ==========================================
    doc.setDrawColor(...azulCorporativo);
    doc.setLineWidth(0.5);
    doc.line(14, 52, 196, 52); 

    doc.setFontSize(10);
    doc.setTextColor(...grisOscuro);
    doc.setFont("helvetica", "bold");
    doc.text("FACTURAR A:", 14, 60);

    doc.setFont("helvetica", "normal");
    doc.setTextColor(0);
    doc.text(`Cliente: ${pedido.usuarioId || "Consumidor Final"}`, 14, 66);
    doc.text("Condici√≥n: Consumidor Final", 14, 71);
    doc.text("Forma de Pago: Contado / Electr√≥nico", 14, 76);

    // ==========================================
    // 3. TABLA DE PRODUCTOS
    // ==========================================
    let totalCalculado = 0;

    const filas = pedido.lineas ? pedido.lineas.map(item => {
      const nombre = item.productoNombre || item.nombre || "Producto sin nombre";
      const precioUnitario = item.productoPrecio || item.precio || 0;
      const cantidad = item.cantidad || 1;
      const subtotal = precioUnitario * cantidad;
      
      totalCalculado += subtotal;

      return [
        nombre,
        cantidad,
        `$ ${precioUnitario.toLocaleString('es-AR', {minimumFractionDigits: 2})}`,
        `$ ${subtotal.toLocaleString('es-AR', {minimumFractionDigits: 2})}`
      ];
    }) : [];

    autoTable(doc, {
      startY: 85,
      head: [["DESCRIPCI√ìN", "CANT.", "PRECIO UNIT.", "SUBTOTAL"]],
      body: filas,
      theme: 'striped',
      headStyles: { 
          fillColor: azulCorporativo, 
          textColor: 255, 
          fontStyle: 'bold',
          halign: 'center'
      },
      styles: { 
          fontSize: 9, 
          cellPadding: 4, 
          valign: 'middle' 
      },
      columnStyles: {
        0: { halign: 'left' },
        1: { halign: 'center' },
        2: { halign: 'right' },
        3: { halign: 'right' }
      },
      alternateRowStyles: {
          fillColor: [245, 245, 250]
      }
    });

    // ==========================================
    // 4. TOTALES (DIN√ÅMICO Y CORREGIDO)
    // ==========================================
    const finalY = doc.lastAutoTable.finalY + 10;
    
    doc.setDrawColor(200);
    doc.setLineWidth(0.1);
    doc.line(130, finalY, 196, finalY); // L√≠nea divisoria

    // Configuraci√≥n de fuente para el PRECIO
    doc.setFontSize(16);
    doc.setFont("helvetica", "bold");
    doc.setTextColor(...azulCorporativo);

    // Preparar el string del precio
    const precioTexto = `$ ${totalCalculado.toLocaleString('es-AR', {minimumFractionDigits: 2})}`;
    
    // --- L√ìGICA CLAVE ---
    // 1. Medimos cu√°nto ocupa el precio en p√≠xeles
    const anchoPrecio = doc.getTextWidth(precioTexto);
    // 2. Definimos d√≥nde termina la hoja (margen derecho)
    const margenDerecho = 196;

    // 3. Imprimimos el precio pegado a la derecha
    doc.text(precioTexto, margenDerecho, finalY + 10, { align: "right" });

    // 4. Calculamos d√≥nde poner la etiqueta "TOTAL A PAGAR"
    //    Posici√≥n = MargenDerecho - AnchoDelPrecio - 5px de aire
    doc.setFontSize(14);
    doc.setTextColor(...grisOscuro);
    
    // Alineamos a la derecha respecto a ese punto calculado, para que crezca hacia la izquierda
    doc.text("TOTAL A PAGAR:", margenDerecho - anchoPrecio - 5, finalY + 10, { align: "right" });

    // ==========================================
    // 5. PIE DE P√ÅGINA
    // ==========================================
    const pageHeight = doc.internal.pageSize.height;
    
    // Franja decorativa oscura
    doc.setFillColor(...grisOscuro);
    doc.rect(0, pageHeight - 15, 210, 15, "F");
    
    doc.setTextColor(255);
    doc.setFontSize(8);
    doc.setFont("helvetica", "normal");
    doc.text("Gracias por su compra en UTN Computer Store", 105, pageHeight - 6, { align: "center" });

    doc.save(`Factura_${pedido.id ? pedido.id.substring(0,5) : 'temp'}.pdf`);

  } catch (error) {
    console.error("‚ùå Error generando PDF:", error);
    alert("Error al generar la factura. Revisa la consola.");
  }
};